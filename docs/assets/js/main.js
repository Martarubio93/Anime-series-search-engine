"use strict";const input=document.querySelector(".input"),resetButton=document.querySelector(".reset"),submitButton=document.querySelector(".submit"),allResultsList=document.querySelector(".js-allresults-list"),favouriteList=document.querySelector(".js-favourite-list"),resetFav=document.querySelector(".fav-btn-js"),imgError="https://via.placeholder.com/210x295/ffffff/666666/?";let allResults=[],favouriteResults=[];function getInfoFromLS(){localStorage.getItem("data")&&(favouriteResults=JSON.parse(localStorage.getItem("data")),paintFavList(favouriteResults))}function getApiInformation(t){let e=input.value;t.preventDefault(),fetch("https://api.jikan.moe/v3/search/anime?q="+e).then(t=>t.json()).then(t=>{allResults=t.results,paintAllResults()})}function paintAllResults(){allResultsList.innerHTML="";for(let t=0;t<allResults.length;t++){const e=allResults[t].image_url.replace(imgError),s=allResults[t].title,l=favouriteResults.findIndex(t=>t.name===s);allResultsList.innerHTML+=l>=0?`<li class="results_container__list--item addtofav fav" data-name="${s}" data-img="${e}" > <img class="results_container__list--img" src="${e}"alt="img"> <h2 class="results_container__list--h2 titles favtitle" >${s}</h2> <p results_container__list--h2> \n      </li>`:`<li class="results_container__list--item addtofav" data-name="${s}" data-img="${e}"> <img class="results_container__list--img" src="${e}" alt="Imagen no encontrada"> <h2 class="results_container__list--h2 titles">${s}</h2></li>`}const t=document.querySelectorAll(".addtofav");for(const e of t)e.addEventListener("click",addToFavList)}function addToFavList(t){const e=t.currentTarget.dataset,s=t.currentTarget.lastChild.previousSibling.nextSibling,l=t.currentTarget;if(console.log(e.name),s.classList.toggle("favtitle"),l.classList.toggle("fav"),l.classList.contains("fav"))favouriteResults.push(e);else{const t=favouriteResults.findIndex(t=>t.name===e.name);favouriteResults.splice(t,1)}localStorage.setItem("data",JSON.stringify(favouriteResults)),paintFavList()}function paintFavList(){favouriteList.innerHTML="";for(let t=0;t<favouriteResults.length;t++){const e=favouriteResults[t].name,s=favouriteResults[t].img.replace(imgError);favouriteList.innerHTML+=null!==s?`<li class="favourite_container__list--item" data-name="${e}" data-img="${s}" > <img class="favourite_container__list--img" src="${s}"><h2 class="favourite_container__list--h2"> ${e} </h2> <span class="delete"> X </span> </li>`:`<li class="favourite_container__list--item" data-name="${e}" data-img="${s}""> <img class="favourite_container__list--img" src="${s}" alt="Imagen no encontrada" <h2 class="results_container__list--h2"> ${e} </h2>  <span class="delete"> X </span></li>`}const t=document.querySelectorAll(".delete");for(const e of t)e.addEventListener("click",deleteElementFromFavList)}function deleteElementFromFavList(t){const e=t.target.parentNode.dataset,s=favouriteResults.findIndex(t=>t.img===e.img);favouriteResults.splice(s,1),paintAllResults(),paintFavList()}function resetAllResults(t){t.preventDefault(),allResultsList.innerHTML="",input.value="",allResults.splice(0,allResults.length)}function resetAllfav(t){t.preventDefault(),favouriteResults.innerHTML="",favouriteResults.splice(0,favouriteResults.length),localStorage.removeItem("data"),paintFavList()}getInfoFromLS(),submitButton.addEventListener("click",getApiInformation),resetButton.addEventListener("click",resetAllResults),resetFav.addEventListener("click",resetAllfav);